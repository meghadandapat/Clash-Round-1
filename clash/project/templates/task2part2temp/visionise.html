
{% load static %}

<html lang="en">

<head>
    <title>Visionise</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <!-- CSS -->
    <script src="https://kit.fontawesome.com/a076d05399.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
        integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <!-- jQuery and JS bundle w/ Popper.js -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
        integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
        crossorigin="anonymous"></script>
    <script src="//cdn.jsdelivr.net/npm/simple-crypto-js@2.5.0/dist/SimpleCrypto.min.js"></script> 
   <link rel="stylesheet" href="{% static '/css/main.css' %}" type="text/css" />
   <script type="text/javascript" src="Winwheel.js"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/gsap/latest/TweenMax.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx"
        crossorigin="anonymous"></script>
    <link rel="stylesheet" type="text/css" href="{% static '/css/style.css' %}">
</head>
<script type="text/javascript">
        window.history.forward();
        function noBack()
        {
            window.history.forward();
        }
</script>
<body onLoad="noBack();" onpageshow="if (event.persisted) noBack();" onUnload="" style="height:100vh;background-image: #B69D74;background-image: radial-gradient(circle, #ede7dd 0%, #c4b08f 70%, #B69D74 100%)">

    <nav class="navbar navbar-expand-lg navbar-light" style="background-color:#1f2839">
        <a class="navbar" href="#">
            <img src="{% static '/images/clashwhite.png' %}" style="width: 80px; height: 40px;"></a>


            <span class="clock" id="time" style="margin-left:20px; color:white;"></span>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav"
                aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
<!--        <div class=status>-->
<!--            <ul class="progressbar">-->
<!--                <li class="active">Que 1</li>-->
<!--                <li>Que 2</li>-->
<!--                <li>Que 3</li>-->
<!--            </ul>-->
<!--        </div>-->


        <div class="collapse navbar-collapse justify justify-content-end" id="navbarNav">
            <ul class="navbar-nav">
                <li class="nav-item fromLeft active">
                    <a class="nav-link active" style="color: white; cursor:pointer;" data-target="#instructionBackdrop" data-toggle="modal">Instructions<span
                            class="sr-only">(current)</span></a>
                </li>
                <li class="nav-item ">
                    <a class="nav-link  nav-right" data-target="#staticBackdrop" data-toggle="modal" href="#" id="log_button"
                       style="color:white">Log out</a>
                </li>

                <li class="nav-item">
                    <img src="{% static '/images/logo pisb_2.png' %}" style="width:115px ;height:40px ;">
                </li>
            </ul>
        </div>

        <div class="modal fade" id="staticBackdrop" data-backdrop="static" data-keyboard="false" tabindex="-1"
            aria-labelledby="staticBackdropLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="staticBackdropLabel">Log out</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        Do you really want to Log out?
                    </div>
                    <div class="modal-footer d-flex justify-content-start">
                        <a href="{%url 'logout'%}"><button type="button" id="logoutcall" class="btn btn-light mybtn">Yes</button></a>
                        <button type="button" class="btn btn-light mybtn" data-dismiss="modal" id="no-button">No</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="instructionBackdrop" data-backdrop="static" data-keyboard="false" tabindex="-1"
         aria-labelledby="staticBackdropLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="instructionBackdropLabel">Instructions for Visionise</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <ul style="text-align: left;">
                        <li>This lifeline will be asked to you only when your total score is between the range of  your predicted score+-5.</li>
                        <li>The marking scheme of the questions present for this lifeline will be +-(total_score/5).
                            E.x. :- if your total score is 11 then (11/5) = 2.2 so it will be floored. So your marking scheme will be +-2.</li>
                        <li>There is a skip button which will be available only after attempting two questions.</li>
                        <li>The time limit for the lifeline is 3:00 minutes.</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    </nav>
<div class="spacing"></div>


    <div class="container-fluid centered-layout">
    

    <div class="row myrow">
        <div class="col-12 col-md-2 mt-3 d-flex flex-column">
            <div class="card-header text-center" style="background-color: #f5f5ef;;font-weight:bolder;">
               Marking Scheme
              </div>
            <div class="card text-center" style="background-color:#1f2839;" >
                <div class="card-body" style="color:white;">
                  <h3 class="card-title"> +{{mks}} | -{{mks}}</h3>
                </div>
              </div>

              <div class="card-header text-center" style="background-color: #f5f5ef;;font-weight:bolder;margin-top:2em">
                Your Score
               </div>
             <div class="card text-center" style="background-color:#1f2839;" >
                 <div class="card-body" style="color:white;">
                   <h3 class="card-title">{{user.total_score}}</h3>
                 </div>
               </div>


        </div>


            <div class="col-md-8 mt-3 ">
                <!-- Question Area -->
                <div class="card mycard" style="height: 42vh;width:100%;background-color: #1f2839; margin:auto">
                    <div class="card-body" style="color:white; font-family:sans-serif;padding:0">
                        <textarea readonly>{{question.question}}</textarea>
                    </div>
                </div>
           
                <!-- Attempt 1 and Attempt 2 -->
                <form action="{% url 'visionise'%}  " method="post">
                    {%csrf_token%}
                <div class="row mt-4">
                    <div class="col-md-12">
                        <div class="switch-field d-flex justify-content-around align-items-center">

                            <input type="radio" id="radio-one" name="user_ans" required="required" value={{question.option_A}}>
                            <label for="radio-one">{{question.option_A}}</label>

                            <input type="radio" id="radio-two" name="user_ans" value={{question.option_B}}>
                            <label for="radio-two">{{question.option_B}}</label>
                        </div>
                        <div class="switch-field d-flex justify-content-around align-items-center">

                            <input type="radio" id="radio-three" name="user_ans" value={{question.option_C}}>
                            <label for="radio-three">{{question.option_C}}</label>

                            <input type="radio" id="radio-four" name="user_ans" value={{question.option_D}}>
                            <label for="radio-four">{{question.option_D}}</label>
                        </div>

                    </div>
                </div>
                <div class="row mt-4">
                    <div class="col-md-12">
                        <div class="d-flex justify-content-center">
                            <button type="submit" name = 'submit' value={{question.id}} style="background-color:#f5f5ef; color:black; margin-right:1em"
                                class="btn mybtn btn-lg">Submit</button>
                        </div>
                    </div>
                </div>
                </form>
            
            </div>
            <div class="col-md-2 mt-3">
                 <!-- completed question-->
                    <div class="" id="que1">
                    <div class="v-stepper">
                        <div class="circle">
                            <i class="" id="que1_tick"></i>
                        </div>
                        <div class="line"></div>
                    </div>

                    <div class="content">
                        Que 1
                    </div>
                </div>

                    <div class="" id="que2">

                    <div class="v-stepper">
                        <div class="circle">
                            <i class="" id="que2_tick"></i>
                        </div>
                        <div class="line"></div>
                    </div>

                    <div class="content">
                        Que 2
                    </div>
                </div>

                        <div class="" id="que3" style="height:auto;">
                        <div class="v-stepper">
                            <div class="circle">
                                <i class="" id="que3_tick"></i>
                            </div>
                        </div>

                        <div class="content">
                            Que 3
                        </div>
                    </div>
                    <form action="{% url 'logout' %} " method="post">
                        {%csrf_token%}
                        
                        <div class="row mt-2" >
                            <div class="col-md-12">
                                <div class="d-flex align-items-center " style="height:7vh">
                    <button type="submit" id="skip_button" style="background-color:#f5f5ef; color:black; margin-top:30px" class="btn mybtn btn-lg">Skip</button>
                                </div>
                                 </div>
                             </div>
                    </form>
            </div>
        </div>
    </div>





    <!-- footer -->

        <footer class="text-center fixed-bottom " style="background-color:#1f2839;">
            <div class="container-fluid">
                <div class="footer-text pt-2 pb-3 text-white" style="font-size: 1.25em; font-family:'Segoe UI'">&#169PICT
                    IEEE Student Branch</div>
    
            </div>
        </footer>
   

    <!-- javascipt for clock -->
    <script>
        var freeze=0;
        function startTimer(duration, display) {
            var timer = {{time_rem}}, minutes, seconds;
            let newtimer=setInterval(function () {
                minutes = parseInt(timer / 60, 10);
                seconds = parseInt(timer % 60, 10);

                minutes = minutes < 10 ? "0" + minutes : minutes;
                seconds = seconds < 10 ? "0" + seconds : seconds;
                if (freeze==0){
                display.textContent = minutes + ":" + seconds;}



                if (--timer < 0) {
                    timer = duration;
                    logoutbutton=document.getElementById("logoutcall");
                    logoutbutton.onclick=occur_Click3();
                    nobutton=document.getElementById("no-button");
                    nobutton.disabled=true;
                }
            }, 1000);
        }

        window.onload = function () {
            var fiveMinutes = {{time_rem}},
                display = document.querySelector('#time');
            startTimer(fiveMinutes, display);
        };
    </script>
<script>
function occur_Click2(){
    document.getElementById("log_button").click();
}
function occur_Click3(){
    document.getElementById("logoutcall").click();
}
</script>
<script>
$('#skip_button').prop("disabled",true);
    function end()
    {
        if({{buttonshow}}===1)
        {
            $('#skip_button').prop("disabled",false);
        }
    }
    end();

</script>

<script>
    let buttonshow={{buttonshow}};
    let que1_state=document.getElementById("que1");
    let que2_state=document.getElementById("que2");
    let que3_state=document.getElementById("que3");

    let que1_tick=document.getElementById("que1_tick");
    let que2_tick=document.getElementById("que2_tick");
    let que3_tick=document.getElementById("que3_tick");

    buttonshow<3?que1_tick.className+="fas fa-check icon":que1_tick.className+="";
    buttonshow<2?que2_tick.className+="fas fa-check icon":que2_tick.className+="";
    buttonshow<1?que3_tick.className+="fas fa-check icon":que3_tick.className+="";

    let que1_completed=buttonshow<3?que1_state.className+="step completed":que1_state.className+="";
    let que1_current=buttonshow===3?que1_state.className+="step active":que1_state.className+="";
    let que2_completed=buttonshow===1?que2_state.className+="step completed":que2_state.className+="";
    let que2_current=buttonshow===2?que2_state.className+="step active":que2_state.className+="";
    let que2_next=buttonshow===3?que2_state.className+="step":que2_state.className+="";
    let que3_current=buttonshow===1?que3_state.className+="step active":que3_state.className+="";
    let que3_next=buttonshow>=2?que3_state.className+="step":que3_state.className+="";


</script>

<script>
      $(window).blur(function () {
        console.log("blur got active");
        $.ajax({
          method: "GET",
          headers: { "X-CSRFToken": token },
          url: `${window.location.origin}/handletab/`,
          dataType: "json",
          data: {},
          success: function (data) {
            alert(
              `You have shifted the tab << Turn Remaining - ${data.checktab} >>`
            );
            if (data.checktab <= 0) {
              logoutbutton = document.getElementById("logoutcall");
              logoutbutton.onclick = occur_Click3();
            }
          },
        });
      });
    </script>

</body>

</html>
